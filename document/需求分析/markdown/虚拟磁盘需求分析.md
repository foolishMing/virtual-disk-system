# 虚拟磁盘系统需求分析文档
  - [1. 修订记录](#1-修订记录)
  - [2. 撰写目的](#2-撰写目的)
  - [3. 需求背景](#3-需求背景)
    - [3.1 系统名称](#31-系统名称)
    - [3.2 系统简介](#32-系统简介)
    - [3.3 功能说明](#33-功能说明)
  - [4. 用例描述](#4-用例描述)
    - [4.1 dir](#41-dir)
      - [4.1.1 dir](#411-dir)
      - [4.1.2 dir [/ad]](#412-dir-ad)
      - [4.1.3 dir [/s]](#413-dir-s)
    - [4.2 md](#42-md)
    - [4.3 rd](#43-rd)
      - [4.3.1 rd](#431-rd)
      - [4.3.2 rd [/s]](#432-rd-s)
    - [4.4 cd](#44-cd)
    - [4.5 del](#45-del)
      - [4.5.1 del](#451-del)
      - [4.5.2 del [/s]](#452-del-s)
    - [4.6 copy](#46-copy)
      - [4.6.1 copy](#461-copy)
      - [4.6.2 copy [/y]](#462-copy-y)
    - [4.7 ren](#47-ren)
    - [4.8 move](#48-move)
      - [4.8.1 move](#481-move)
      - [4.8.2 move [/y]](#482-move-y)
    - [4.9 mklink](#49-mklink)
      - [4.9.1 mklink](#491-mklink)
      - [4.9.2 mklink [/d]](#492-mklink-d)
    - [4.10 save](#410-save)
    - [4.11 load](#411-load)
    - [4.12 cls](#412-cls)

## 1. 修订记录

| 版本 | 更新时间   | 更新内容     | 更新人 |
| ---- | ---------- | ------------ | ------ |
| V1.0 | 2021.06.24 | 确定文档结构 | 郝绍明 |
| V1.1 | 2021.06.25 | 完善用例描述 | 郝绍明 |
| v1.2 | 2021.06.28 | 生成目录     | 郝绍明 |



## 2. 撰写目的

本文的主要内容为对虚拟磁盘系统界面、功能、使用场景的说明与描述。

预期读者：项目管理人员、项目开发人员、用户。



## 3. 需求背景

### 3.1 系统名称

虚拟磁盘系统

### 3.2 系统简介

虚拟磁盘软件能够在内存中模拟一个磁盘，通过接受命令，可以在内存中完成一些文件操作的功能。

### 3.3 功能说明

| 命令   | 释义                       |
| ------ | -------------------------- |
| dir    | 列出当前目录下的目录和文件 |
| md     | 创建目录                   |
| rd     | 删除目录                   |
| cd     | 切换当前目录               |
| del    | 删除文件                   |
| copy   | 拷贝文件                   |
| ren    | 重命名                     |
| move   | 移动                       |
| mklink | 创建符号链接               |
| save   | 将虚拟磁盘序列化为文件     |
| load   | 将文件反序列化为虚拟磁盘   |
| cls    | 清屏                       |



## 4. 用例描述

### 4.1 dir

#### 4.1.1 dir

| 用例名称   | dir                                                          |
| ---------- | ------------------------------------------------------------ |
| 用例标识号 | VD0001-01                                                    |
| 简要说明   | 功能：列出目录中的文件和子目录<br />格式：dir  [path1] [path2]...... |
| 前置条件   | 接收一条合法的命令行语句                                     |
| 基本事件流 | 1、列出目录中的文件和子目录列表;<br />2、分别显示文件数量及目录数量；<br />3、分别显示已使用字节数量及可用字节数量 |
| 其他事件流 |                                                              |
| 异常事件流 | 1、该路径不存在<br />2、路径长度超出限制<br />3、参数格式不正确 |
| 后置条件   | 打印当前路径，并等待用户的输入                               |
| 注释       |                                                              |

#### 4.1.2 dir [/ad]

| 用例名称   | dir\_ad                                                      |
| ---------- | ------------------------------------------------------------ |
| 用例标识号 | VD0001-02                                                    |
| 简要说明   | 功能：列出目录中的子目录<br />格式：dir  /ad [path1] [path2]...... |
| 前置条件   | 接收一条合法的命令行语句                                     |
| 基本事件流 | 列出目录中的子目录列表;<br />分别显示文件数量及目录数量；<br />分别显示已使用字节数量及可用字节数量 |
| 其他事件流 |                                                              |
| 异常事件流 | 1、该路径不存在<br />2、路径长度超出限制<br />3、参数格式不正确 |
| 后置条件   | 打印当前路径，并等待用户的输入                               |
| 注释       |                                                              |

#### 4.1.3 dir [/s]

| 用例名称   | dir_s                                                        |
| ---------- | ------------------------------------------------------------ |
| 用例标识号 | VD0001-03                                                    |
| 简要说明   | 功能：列出目录及子目录下所有的文件<br />格式：dir  /s [path1] [path2]...... |
| 前置条件   | 接收一条合法的命令行语句                                     |
| 基本事件流 | 列出目录及其子目录下所有文件;<br />分别显示文件数量及目录数量；<br />分别显示已使用字节数量及可用字节数量 |
| 其他事件流 |                                                              |
| 异常事件流 | 1、该路径不存在<br />2、路径长度超出限制<br />               |
| 后置条件   | 打印当前路径，并等待用户的输入                               |
| 注释       |                                                              |

### 4.2 md

| 用例名称   | md                                                                                                          |
| ---------- | ----------------------------------------------------------------------------------------------------------- |
| 用例标识号 | VD0002-01                                                                                                   |
| 简要说明   | 功能：创建目录 <br />格式：mkdir path                                                                       |
| 前置条件   | 接收一条合法的命令行语句                                                                                    |
| 基本事件流 | 在当前目录下，创建一个子目录                                                                                |
| 其他事件流 |                                                                                                             |
| 异常事件流 | 1、可用内存空间不足，创建失败<br />2、目录路径层次超出限制，创建失败<br />3、同名目录或文件已存在，创建失败 |
| 后置条件   | 打印当前路径，并等待用户的输入                                                                              |
| 注释       |                                                                                                             |

### 4.3 rd

#### 4.3.1 rd

| 用例名称   | rd                                                           |
| ---------- | ------------------------------------------------------------ |
| 用例标识号 | VD0003-01                                                    |
| 简要说明   | 功能：删除一个空目录<br />格式：rd path [path1] ...          |
| 前置条件   | 接收一条合法的命令行语句                                     |
| 基本事件流 | 1、判断该目录是否为空<br />2、若为空目录，则删除<br />3、打印删除记录 |
| 其他事件流 |                                                              |
| 异常事件流 | 1、非空目录，删除失败<br />2、该路径不存在                   |
| 后置条件   | 打印当前路径，并等待用户的输入                               |
| 注释       |                                                              |

#### 4.3.2 rd [/s]

| 用例名称   | rd_s                                                         |
| ---------- | ------------------------------------------------------------ |
| 用例标识号 | VD0003-02                                                    |
| 简要说明   | 功能：递归删除目录及其所有子目录下所有文件<br />格式：rd /s path [path1] ... |
| 前置条件   | 接收一条合法的命令行语句                                     |
| 基本事件流 | 1、递归遍历当前目录<br />2、对任意子目录，递归删除其下所有子目录及文件<br />3、对任意文件，直接删除<br />4、打印删除记录 |
| 其他事件流 |                                                              |
| 异常事件流 | 1、该路径不存在                                              |
| 后置条件   | 打印当前路径，并等待用户的输入                               |
| 注释       |                                                              |

### 4.4 cd

| 用例名称   | cd                                                           |
| ---------- | ------------------------------------------------------------ |
| 用例标识号 | VD0004-01                                                    |
| 简要说明   | 功能：显示当前目录名，或切换当前目录<br />格式：cd [path]    |
| 前置条件   | 接收一条合法的命令行语句                                     |
| 基本事件流 | 1、若path为当前路径，则显示当前目录名<br />2、若path为子目录，则将当前目录切换为path |
| 其他事件流 |                                                              |
| 异常事件流 | 1、该路径不存在                                              |
| 后置条件   | 打印当前路径，并等待用户的输入                               |
| 注释       |                                                              |

### 4.5 del

#### 4.5.1 del

| 用例名称   | del                                                          |
| ---------- | ------------------------------------------------------------ |
| 用例标识号 | VD0005-01                                                    |
| 简要说明   | 删除指定文件<br />del [/s] path [path1]...                   |
| 前置条件   | 接收一条合法的命令行语句                                     |
| 基本事件流 | 1、遍历当前目录<br />2、对于文件，若为指定文件，则删除<br />3、打印删除记录 |
| 其他事件流 |                                                              |
| 异常事件流 | 1、该路径不存在，删除失败<br />2、该路径指向目录，删除失败   |
| 后置条件   | 打印当前路径，并等待用户的输入                               |
| 注释       |                                                              |

#### 4.5.2 del [/s]

| 用例名称   | del_s                                                        |
| ---------- | ------------------------------------------------------------ |
| 用例标识号 | VD0005-02                                                    |
| 简要说明   | 删除当前目录及其所有子目录下的指定文件<br />del [/s] path [path1]... |
| 前置条件   | 接收一条合法的命令行语句                                     |
| 基本事件流 | 1、遍历当前目录<br />2、对于文件，若为指定文件，则删除<br />3、对于子目录，遍历并删除其中的指定文件<br />4、打印删除记录 |
| 其他事件流 |                                                              |
| 异常事件流 | 1、该路径不存在，删除失败<br />2、该路径指向目录，删除失败   |
| 后置条件   | 打印当前路径，并等待用户的输入                               |
| 注释       |                                                              |

### 4.6 copy

#### 4.6.1 copy

| 用例名称   | copy                                                         |
| ---------- | ------------------------------------------------------------ |
| 用例标识号 | VD0006-01                                                    |
| 简要说明   | 功能：将本地指定文件拷贝到虚拟磁盘指定目录中，路径信息需要支持通配符 <br />格式：copy path1 path2 |
| 前置条件   | 接收一条合法的命令行语句                                     |
| 基本事件流 | 1、创建虚拟文件<br />2、打开本地文件<br />3、将本地文件内容按字节复制到虚拟文件中<br />4、关闭本地文件<br />5、关闭虚拟文件 |
| 其他事件流 |                                                              |
| 异常事件流 | 1、虚拟文件路径已存在，提示用户覆盖文件或取消操作<br />2、本地文件路径不存在，打开失败<br />3、复制过程被打断，虚拟磁盘中产生脏数据<br />4、虚拟磁盘可用空间不足，复制失败 |
| 后置条件   | 打印当前路径，并等待用户的输入                               |
| 注释       |                                                              |

#### 4.6.2 copy [/y]

| 用例名称   | copy                                                         |
| ---------- | ------------------------------------------------------------ |
| 用例标识号 | VD0006-02                                                    |
| 简要说明   | 功能：将本地指定文件拷贝到虚拟磁盘指定目录中，如果目标文件已存在，则默认强制覆盖 |
| 前置条件   | 接收一条合法的命令行语句                                     |
| 基本事件流 | 1、创建虚拟文件<br />2、打开本地文件<br />3、将本地文件内容按字节复制到虚拟文件中<br />4、关闭本地文件<br />5、关闭虚拟文件 |
| 其他事件流 |                                                              |
| 异常事件流 | 1、虚拟文件路径已存在，强制覆盖<br />2、本地文件路径不存在，打开失败<br />3、复制过程被打断，虚拟磁盘中产生脏数据<br />4、虚拟磁盘可用空间不足，复制失败 |
| 后置条件   | 打印当前路径，并等待用户的输入                               |
| 注释       |                                                              |

### 4.7 ren

| 用例名称   | ren                                                          |
| ---------- | ------------------------------------------------------------ |
| 用例标识号 | VD0007-01                                                    |
| 简要说明   | 功能：给一个文件或目录改名<br />格式：ren src dst            |
| 前置条件   | 接收一条合法的命令行语句                                     |
| 基本事件流 | 1、查找路径src下的目标文件<br />2、将目标文件改名为dst       |
| 其他事件流 |                                                              |
| 异常事件流 | 1、src路径不存在，提示用户“系统找不到指定的文件”<br />2、dst路径已存在，提示用户“存在重名文件” |
| 后置条件   | 打印当前路径，并等待用户的输入                               |
| 注释       |                                                              |

### 4.8 move

#### 4.8.1 move

| 用例名称   | move                                                         |
| ---------- | ------------------------------------------------------------ |
| 用例标识号 | VD0008-01                                                    |
| 简要说明   | 功能： 移动一个或者多个（文件/文件夹）<br />格式：move  src dst |
| 前置条件   | 接收一条合法的命令行语句                                     |
| 基本事件流 | 1、若src是目录路径，dst是目录路径，则将src整体复制到dst目录下<br />2、若src是文件路径，dst是目录路径，则将src所匹配的所有源文件复制到dst目录下 |
| 其他事件流 |                                                              |
| 异常事件流 | 1、dst不是合法的目录路径<br />2、src不是合法的（文件或目录）路径<br />3、若目标路径下存在同名目录或文件，提示用户强制覆盖或取消操作 |
| 后置条件   | 打印当前路径，并等待用户的输入                               |
| 注释       |                                                              |

#### 4.8.2 move [/y]

| 用例名称   | move_y                                                       |
| ---------- | ------------------------------------------------------------ |
| 用例标识号 | VD0008-02                                                    |
| 简要说明   | 功能： 移动一个或者多个（文件/文件夹），并默认强制覆盖<br />格式：move  src dst |
| 前置条件   | 接收一条合法的命令行语句                                     |
| 基本事件流 | 1、若src是目录路径，dst是目录路径，则将src整体复制到dst目录下<br />2、若src是文件路径，dst是目录路径，则将src所匹配的所有源文件复制到dst目录下 |
| 其他事件流 |                                                              |
| 异常事件流 | 1、dst不是合法的目录路径<br />2、src不是合法的（文件或目录）路径<br />3、若目标路径下存在同名目录或文件，默认强制覆盖 |
| 后置条件   | 打印当前路径，并等待用户的输入                               |
| 注释       |                                                              |

### 4.9 mklink

#### 4.9.1 mklink

| 用例名称   | mklink                                                       |
| ---------- | ------------------------------------------------------------ |
| 用例标识号 | VD0009-01                                                    |
| 简要说明   | 功能：创建一个文件符号链接<br />格式：mklink srcPath symbolLinkPath |
| 前置条件   | 接收一条合法的命令行语句                                     |
| 基本事件流 | 1、为源目录/文件创建一个文件符号链接                         |
| 其他事件流 |                                                              |
| 异常事件流 | 1、路径不存在<br />2、目标链接已存在，无法重复创建<br />     |
| 后置条件   | 打印当前路径，并等待用户的输入                               |
| 注释       |                                                              |

#### 4.9.2 mklink [/d]

| 用例名称   | mklink_d                                                     |
| ---------- | ------------------------------------------------------------ |
| 用例标识号 | VD0009-02                                                    |
| 简要说明   | 功能：创建一个目录符号链接<br />格式：mklink [/d] dir_link dir |
| 前置条件   | 接收一条合法的命令行语句                                     |
| 基本事件流 | 1、为源目录/文件创建一个目录符号链接                         |
| 其他事件流 |                                                              |
| 异常事件流 | 1、路径不存在<br />2、目标链接已存在，无法重复创建           |
| 后置条件   | 打印当前路径，并等待用户的输入                               |
| 注释       |                                                              |

### 4.10 save

| 用例名称   | save                                                         |
| ---------- | ------------------------------------------------------------ |
| 用例标识   | VD0010-01                                                    |
| 简要说明   | 功能：将虚拟磁盘序列化为本地文件                             |
| 前置条件   | 接收一条合法的命令行语句                                     |
| 基本事件流 | 1、创建并打开本地文件<br />2、将序列化后的虚拟磁盘信息写入本地文件<br />3、关闭本地文件 |
| 其他事件流 |                                                              |
| 异常事件流 | 1、本地文件已存在，提示用户，可选择强制覆盖或取消命令<br />2、序列化过程被打断，本地文件成为脏数据<br />3、本地磁盘可用空间不足，写入失败<br />4、存在不合法的路径 |
| 后置条件   | 打印当前路径，并等待用户的输入                               |
| 注释       |                                                              |

### 4.11 load

| 用例名称   | load                                                                                                      |
| ---------- | --------------------------------------------------------------------------------------------------------- |
| 用例标识号 | VD0011_01                                                                                                 |
| 简要说明   | 功能：从磁盘载入文件，重建虚拟磁盘<br />格式：load dstPath                                                |
| 前置条件   | 接收一条合法的命令行语句                                                                                  |
| 基本事件流 | 1、打开本地文件<br />2、建立虚拟磁盘<br />3、载入该虚拟磁盘，同时销毁当前磁盘<br />4、关闭本地文件        |
| 其他事件流 |                                                                                                           |
| 异常事件流 | 1、文件数据格式错误，无法解析<br />2、虚拟磁盘可用空间不足，写入失败<br />3、本地文件路径不存在，加载失败 |
| 后置条件   | 打印当前路径，并等待用户的输入                                                                            |
| 注释       |                                                                                                           |

### 4.12 cls

| 用例名称   | cls                                                     |
| ---------- | ------------------------------------------------------- |
| 用例标识号 | VD0012_01                                               |
| 简要说明   | 功能：清空屏幕，并将光标定位在屏幕第一行<br />格式：cls |
| 前置条件   | 接收一条合法的命令行语句                                |
| 基本事件流 | 1、清空屏幕<br />2、将光标重定位                        |
| 其他事件流 |                                                         |
| 异常事件流 |                                                         |
| 后置条件   | 打印当前路径，并等待用户的输入                          |
| 注释       |                                                         |

